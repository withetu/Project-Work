---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
## SRC: http://www.lunametrics.com/blog/2015/11/23/export-google-analytics-data-with-r/ 

install.packages("devtools")
install_github("skardhamar/rga", force = TRUE)
install.packages("httr")
install.packages("xlsx")
install.packages("RODBC")
library(devtools)
library(curl)
library(RCurl)
library(bitops)
library(jsonlite)
library(httr)
library(rga)
library(ggplot2)
library(xlsx)
library(RODBC)  

rga.open(instance = "ga")
id <- 46730774
gaData <- ga$getData(id, start.date = as.Date("2016-10-01"), end.date = as.Date("2016-10-31"))
##clusters <- hclust(dist(gaData[,3:4]))
##plot(clusters)

gaData <- ga$getData(id, start.date = as.Date("2016-10-01"), 
                     end.date=as.Date("2016-10-31"), metrics = "ga:pageviews,ga:BounceRate,ga:AvgSessionDuration")

##gaData <- ga$getData(id, start.date = as.Date("2016-10-01"), 
                   ##end.date=as.Date("2016-10-31"), metrics = "ga:pageviews,ga:entrances",
                     ##dimensions = "ga:date", filter = "ga:country=~United States|Canada;ga:medium==organic",
                     ##sort = "-ga:pageviews", batch = TRUE)

gaData <- ga$getData(id, start.date = as.Date("2016-10-01"), 
                   end.date=as.Date("2016-10-31"), metrics = "ga:pageviews",
                   dimensions = "ga:date")

ggplot(gaData, aes(date, pageviews)) + geom_line() + 
  ylab("Daily Pageviews") + theme_bw() + 
  ggtitle("Monthly Pageviews")

write.csv(gaData, "ALC-GA-OCT1.csv")
getwd()
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
